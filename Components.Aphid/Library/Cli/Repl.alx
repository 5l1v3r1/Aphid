var repl = {
    run: @(scope){
        using Components.Aphid.UI;
        var aphidScope = this;        
        var a = aphidScope.{'$aphid'};

        if (a defined && scope defined) {
            a.SetInitialScope(scope);
        }

        var r = a defined ? new AphidRepl(a) : new AphidRepl();

        try r.Run();
        finally r.Dispose();
    }
};
